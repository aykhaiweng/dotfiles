#!/usr/bin/env bash

if [[ "$1" ]]; then
    this_dir=$1
else
    this_dir=$(pwd)
fi

cleaned_dirname=$(echo $(basename $this_dir) | sed "s/[\.]//g")
if [[ $(tmux ls -F "#S" | grep $cleaned_dirname) ]]; then
    # Do this if the session exists
    if [ -z "$TMUX" ]; then
        # Do this is out of tmux
        tmux a -t $cleaned_dirname
    else
        tmux switch -t $cleaned_dirname
    fi
else
    if [ -z "$TMUX" ]; then
        # Do this is out of tmux
        tmux new -A -s $cleaned_dirname -c $this_dir
    else
        tmux new -A -s $cleaned_dirname -c $this_dir -d
    fi
fi
